<html>
	<head>
	</head>
	<body>
	<button>asd</button>
	<canvas id ="canvas" ></canvas>>
    <script src="pdf.js"></script>asda
    a
    sd
    asd
    s
    <script type="text/javascript">
    	//var pdfAsDataUri = "data:application/pdf;base64,JVBERi0xLjUK..."; // shortened
		//var pdfAsArray = convertDataURIToBinary(pdfAsDataUri);

		url = s.session.url('/web_tiff_widget/BinaryTiff/tiff', {
                                        model: "rbs.documento.mercantil.acta",
                                        id: "1",
                                        field: "filedata",
                                        t: (new Date().getTime()),});
		var xhr = new XMLHttpRequest();
	    xhr.open('GET', url);
	    xhr.responseType = 'arraybuffer';

	    $canv = $('#imagenCanvas')
	    $ctx = $canv[0].getContext("2d");
	    lienzo = new CanvasState($canv[0]);
	    xhr.onload = function (e) {
	            var tiff;    
	            var buffer = xhr.response;
	            //console.log((buffer))
	            tiff = new Tiff({buffer: buffer});
	            lenTiff =  tiff.countDirectory();
	            for (var i = 0, len = tiff.countDirectory(); i < len; ++i) {
	                tiffs.push(new tifClass(tiff,i));
	            }
	            on_change();
	                
	    }


	    xhr.send();
		PDFJS.getDocument("sri.pdf").then(function(pdf) {
		  // Using promise to fetch the page
		  for (var i = 1; i <= pdf.numPages; i++) {
		  	pdf.getPage(i).then(function(page) {
			  	console.log(page);
			    var scale = 10;
			    var viewport = page.getViewport(scale);

			    //
			    // Prepare canvas using PDF page dimensions
			    //
			    var canvas = document.getElementById('canvas');
			    var context = canvas.getContext('2d');
			    canvas.height = viewport.height;
			    canvas.width = viewport.width;

			    //
			    // Render PDF page into canvas context
			    //
			    var renderContext = {
			      canvasContext: context,
			      viewport: viewport
			    };
			    console.log(page.render(renderContext));
			  });
		  }
		  
		});
    </script>>
	</body>
</html>